<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="../lib/jquery-3.2.1.js"></script>
    <title>小球浮动</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        li {
            list-style: none;
        }

        #main {
            width: 400px;
            height: 500px;
            position: relative;
            background-color: seagreen;
            margin: 100px auto;
        }

        .ball {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: salmon;
            position: absolute;
        }
        @keyframes ballfloat {
            0%{
                transform: translateY(5px);
            }
            50%,100%{
                transform: translateY(0);
            }
            75%{
                transform: translateY(-5px);
            }
        }
        #tree {
            width: 0;
            height: 0;
            border-left: 50px solid transparent;
            border-right: 50px solid transparent;
            border-bottom: 200px solid red;
            position: absolute;
            left: 50%;
            bottom: 0;
            transform: translateX(-50%);
        }
    </style>
</head>

<body>
    <div id="main">
        <div class="ball"></div>
        <div class="ball"></div>
        <div class="ball"></div>
        <div class="ball"></div>
        <div class="ball"></div>
        <div class="ball"></div>

        <div id='tree'></div>
    </div>
    <script>
        $(function () {
            let $tree = $("#tree"),
                $main = $("#main");
            let main_w = $main.width(),
                main_h = $main.height();
            let tree_w = $tree.get(0).offsetWidth,
                tree_h = $tree.get(0).offsetHeight;
            console.log('tree_w', tree_w);
            console.log('tree_h', tree_h);
            console.log('main_w', main_w);
            console.log('main_h', main_h);
            let $ball = $(".ball");
            let ball_len = $ball.length;
            console.log('ball_len', ball_len);
            let top_tree = (main_h - tree_h - 50);
            let overtop_width = Math.floor((main_w - tree_w - 20) / 2);

            let tree_r = Math.ceil((Math.sqrt(Math.pow(tree_w, 2) + Math.pow(tree_h, 2))) / 2) + 30;
            let deg = Math.floor(180 / ball_len);

            // let left_arr = randomNM(main_w, 50, ball_len);
            console.log('tree_r', tree_r);
            console.log('deg', deg);
            let deg_arr = [100, 130, 160, 190, 220, 250]
            let r_x = Math.floor(main_w / 2),
                r_y = Math.floor(tree_h / 2);
            console.log('r_x', r_x);
            console.log('r_y', r_y);

            $('.ball').each(function (index) {
                let hudu = (2 * Math.PI / 360) * deg_arr[index];
                let x = Math.ceil(r_x + Math.sin(hudu) * tree_r-Math.random()*10),
                    y = Math.ceil(r_y - Math.cos(hudu) * tree_r+Math.random()*60);
                console.log('x', x);
                console.log('y', y);
                let delay= Math.floor(Math.random()*500+300);
                $(this).css({
                    left:x,
                    bottom:y,
                    animation: `ballfloat 2s linear ${delay}ms infinite`
                });
            });
            function randomNM(n, m, len) { // 生成随机多少个数组  
                let array = new Array(n)
                    .fill(0)
                    .map((v, i) => i + m)
                    .sort(() => 0.5 - Math.random())
                    .filter((v, i) => i < len);
                return array;
            }
        });
    </script>
</body>

</html>